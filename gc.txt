#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int i=0, j=0;

char** gray(int n){
    if(n==1){
        char** arr = malloc(2*sizeof(char*));
        arr[0] = malloc(1*sizeof(char));
        arr[1] = malloc(1*sizeof(char));
        arr[0][0] = '0';
        arr[1][0] = '1';
        return arr;
    }
    else{
        char** prev = gray(n-1);
        char** all = malloc(pow(2,n)*sizeof(char*));
        for(i=0; i<pow(2,n); i++) all[i] = malloc(n*sizeof(char));
        
        for(i=0; i<pow(2,n); i++){
            for(j=0; j<n; j++){
                if(j==0){
                    if(i<pow(2,n-1)) all[i][0] = '0';
                    else all[i][0] = '1';
                }
                else{
                    if(i<pow(2,n-1)) all[i][j] = prev[i][j-1];
                    else all[i][j] = prev[ (int)pow(2,n)-1-i ][j-1];                    
                }
            }
        }
        
        /*
        // fill first bit
        for(i=0; i<pow(2,n); i++){
            if(i<pow(2,n-1)) all[i][0] = '0';
            else all[i][0] = '1';
        }
        
        // fill left half   
        for(i=0; i<pow(2,n-1); i++){
            for(j=0; j<n; j++){
                all[i][j+1] = prev[i][j]; 
            }
        }*/
        
        return all;
    }
}

int main()
{
    int n=3;
    char** g = gray(n);
    for(i=0; i<pow(2,n); i++){
        for(j=0; j<n; j++){
            printf("%c", g[i][j]);
        }
        printf("\n");
    }

    return 0;
}