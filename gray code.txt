#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int i=0, j=0;

char** gray(int n){
    if(n==1){
        char** arr = malloc(2*sizeof(char*));
        arr[0] = malloc(1*sizeof(char));
        arr[1] = malloc(1*sizeof(char));
        arr[0][0] = '0';
        arr[1][0] = '1';
        return arr;
    }
    else{
        char** prev = gray(n-1);
        char** all = malloc(pow(2,n)*sizeof(char*));
        for(i=0; i<pow(2,n); i++) all[i] = malloc(n*sizeof(char));
        
        for(i=0; i<pow(2,n); i++){
            for(j=0; j<n; j++){
                if(j==0){
                    if(i<pow(2,n-1)) all[i][0] = '0';
                    else all[i][0] = '1';
                }
                else{
                    if(i<pow(2,n-1)) all[i][j] = prev[i][j-1];
                    else all[i][j] = prev[ (int)pow(2,n)-1-i ][j-1];                    
                }
            }
        }
        return all;
    }
}

/*
0 7 8  15
1 6 9  14
2 5 10 13
3 4 11 12
down %8=0,1,2,3 %8<4
up   %8=4,5,6,7

n=2 m=2 (-1,1) 0<1>
n=4 m=4 (-3,3) -2 0 2<3>
n=6 m=8 (-7,7) -6 -4 -2 0 2 4 6<7>
n=8 m=16 (-15,15) -14 -12 ... 14<15>
n=n m=2^(n/2) (-m+1, m-1) -m+2 ... m-2<m-1>
                            0 1 2 .. m-2	floor((+m-2)/2)
                            m-2 .. 2 1 0

x -3 -1 1 3 -> id1 0 1 2 3      f(x)=floor((x+3)/2)
y 3 1 -1 -3 -> id0 0 1 2 3      f(x)=floor((3-x)/2)
f((1.7+3)/2)=2 id1=2~3
f((-1.5+3)/2)=0 id1=0~1
f((3-1.7)/2)=0 id0=0~1
f((3--1.5)/2)=2 id0=2~3
*/

int** snake(int m){
    int** snake = malloc(m*sizeof(int*));
    for(i=0; i<m; i++) snake[i] = malloc(m*sizeof(int));
    
    for(i=0; i<m*m; i++){
        if(i%(2*m)<m) snake[i%m][i/m] = i;
        else snake[m-1-i%m][i/m] = i;
    }
    return snake;
}

/*int* map(int i, int j, int m){
    int* vec = malloc(2*sizeof(int));
    vec[0] = m  +j;
    vec[1] = m  -i;
    return vec;
}
double dist(int x1, int y1, int x2, int y2){
    return sqrt(pow(x1-x2,2)+pow(y1-y2,2));
}*/

int nearst(double x, double y){
    return 0;
}

int main()
{
    int n=3;
    char** g = gray(n);
    for(i=0; i<pow(2,n); i++){
        for(j=0; j<n; j++){
            printf("%c", g[i][j]);
        }
        printf("\n");
    }
    
    printf("\n");
    int m=4;
    int** s = snake(m);
    for(i=0; i<m; i++){
        for(j=0; j<m; j++) printf("%d ", s[i][j]);
        printf("\n");
    }

    return 0;
}
